"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[288],{8661:(e,t,o)=>{o.d(t,{Z:()=>n});var a=o(8874);const n={props:{tenant:Object,plan:Object},components:{},created:function(){this.startMp()},mounted:function(){},data:function(){return{loadPayment:!1,cardnumber:"",cpf:"",expiration:"",card_expiration:{expirationMonth:"",expirationYear:""},showstallmants:!1,paymentMethodId:""}},computed:{},methods:{_payCard:function(){this.loadPayment=!0,document.getElementById("docNumber").value=this.cpf.replace(/[^a-zA-Z0-9]/g,""),document.getElementById("docType").value="CPF",window.Mercadopago.createToken(document.getElementById("pay"),this.setCardTokenAndPay)},setCardTokenAndPay:function(e,t){var o=this;if(200==e||201==e){var n,r=document.getElementById("installments");axios.post("/api/v1/paycard",{token:t.id,payment_method_id:this.paymentMethodId,plan_id:this.plan.id,email:document.getElementById("email").value,installments:null!==(n=null==r?void 0:r.value)&&void 0!==n?n:1,cpf:this.cpf.replace(/[^a-zA-Z0-9]/g,"")}).then((function(e){var t=e.data;a.Am.success("Transação realizado com sucesso",{autoClose:3e3}),window.location.href=t.redirect})).catch((function(e){o.clearCardForm(),a.Am.error("Erro na transação",{autoClose:3e3})})).finally((function(){o.loadPayment=!1}))}else this.loadPayment=!1,this._setError(t.cause[0].code)},setPaymentMethod:function(e,t){200==e?(this.paymentMethodId=t[0].id,document.getElementById("secure_thumbnail").src=t[0].secure_thumbnail):alert("".concat(t))},getIssuers:function(e){window.Mercadopago.getIssuers(e,this.setIssuers)},setIssuers:function(e,t){if(200==e){var o=document.getElementById("issuer");t.forEach((function(e){var t=document.createElement("option");t.text=e.name,t.value=e.id,o.appendChild(t)}))}else alert("issuers method info error: ".concat(t))},getInstallments:function(){window.Mercadopago.getInstallments({payment_method_id:this.paymentMethodId,amount:parseFloat(document.getElementById("transactionAmount").value),issuer_id:25},this.setInstallments)},setInstallments:function(e,t){200==e?(this.showstallmants=!0,document.getElementById("installments").options.length=0,t[0].payer_costs.forEach((function(e){var t=document.createElement("option");t.text=e.recommended_message,t.value=e.installments,document.getElementById("installments").appendChild(t)}))):this.showstallmants=!1},_setError:function(e){"205"===e&&a.Am.error("Digite o número do seu cartão.",{autoClose:3e3}),"E301"===e&&a.Am.error("Número do cartão inválido.",{autoClose:3e3}),"E302"===e&&a.Am.error("Confira o código de segurança.",{autoClose:3e3}),"221"===e&&a.Am.error("Digite o nome impresso no cartão.",{autoClose:3e3}),"208"!==e&&"209"!==e||a.Am.error("Digite o vencimento cartão.",{autoClose:3e3}),"325"!==e&&"326"!==e||a.Am.error("Vencimento do cartão inválido.",{autoClose:3e3}),"214"===e&&a.Am.error("Informe o número do seu CPF.",{autoClose:3e3}),"324"===e&&a.Am.error("Número do CPF inválido.",{autoClose:3e3})},clearCardForm:function(){document.getElementById("cardNumber").value="",document.getElementById("secure_thumbnail").src="",document.getElementById("cardExpirationMonth").value="",document.getElementById("cardExpirationYear").value="",document.getElementById("paymentMethodId").value="",document.getElementById("cardholderName").value="",document.getElementById("securityCode").value="",document.getElementById("email").value="",document.getElementById("docType").value="",document.getElementById("docNumber").value="",this.cardnumber="",this.cpf="",this.expiration="",this.card_expiration={expirationMonth:"",expirationYear:""},this.showstallmants=!1,this.startMp()},startMp:function(){var e=this,t=document.createElement("script");t.src="https://secure.mlstatic.com/sdk/javascript/v1/mercadopago.js",t.addEventListener("load",(function(){window.Mercadopago.setPublishableKey(e.tenant.mpkey)})),document.body.appendChild(t);var o=document.querySelector("iframe");o&&(document.body.removeChild(o),document.body.removeChild(t))}},watch:{cardnumber:function(){var e=this.cardnumber.replace(/\s/g,"");e.length>=7&&window.Mercadopago.getPaymentMethod({bin:e.substring(0,6)},this.setPaymentMethod),16==e.length&&document.getElementById("paymentMethodId").value&&this.getInstallments()},paymentMethodId:function(){16==this.cardnumber.replace(/\s/g,"").length&&this.paymentMethodId&&this.getInstallments()},expiration:function(){if(this.expiration.includes("/")){var e=this.expiration.split("/");this.card_expiration.expirationMonth=e[0],this.card_expiration.expirationYear=e[1]}}}}},2231:(e,t,o)=>{o.d(t,{s:()=>k});var a=o(821),n={id:"pay"},r={class:"row"},d={class:"form-group mt-2 col-md-8"},l=(0,a._)("label",{class:"mb-1"},[(0,a._)("span",null,[(0,a._)("img",{id:"secure_thumbnail"})]),(0,a.Uk)(" Número do cartão: ")],-1),s={class:"form-group mt-2 col-md-4"},i=(0,a._)("label",{class:"mb-1"},"Vencimento:",-1),c=["value"],m=["value"],u=(0,a._)("input",{type:"hidden",id:"paymentMethodId"},null,-1),p=(0,a._)("input",{type:"hidden",id:"transactionAmount",value:"100"},null,-1),h=(0,a._)("div",{class:"form-group mt-2 col-md-8"},[(0,a._)("label",{class:"mb-1"},"Nome impresso no cartão:"),(0,a._)("input",{type:"text",id:"cardholderName",placeholder:"",class:"text-uppercase form-control form-control-sm","data-checkout":"cardholderName"})],-1),y={class:"form-group mt-2 col-md-4"},_=(0,a._)("label",{class:"mb-1"},"CVV:",-1),f={type:"text",id:"securityCode",placeholder:"",class:"form-control form-control-sm","data-checkout":"securityCode"},v={class:"form-group mt-2 col-md-12"},g=[(0,a._)("label",{class:"mb-1"},"Parcelas:",-1),(0,a._)("select",{class:"form-select form-select-sm",id:"installments"},null,-1)],b=(0,a._)("div",{class:"form-group mt-2 col-md-12"},[(0,a._)("label",{class:"mb-1"},"EMAIL:"),(0,a._)("input",{type:"email",id:"email",placeholder:"",class:"form-control form-control-sm"})],-1),I={class:"form-group mt-2 col-md-12"},E=(0,a._)("label",{class:"mb-1"},"CPF:",-1),x=(0,a._)("input",{id:"docType",value:"CPF","data-checkout":"docType",type:"hidden"},null,-1),C=["value"],M={class:"text-right mt-2 d-grid gap-2"},w=["disabled"];function k(e,t,o,k,B,P){var A=(0,a.Q2)("mask");return(0,a.wg)(),(0,a.iD)("form",n,[(0,a._)("div",r,[(0,a._)("div",d,[l,(0,a.wy)((0,a._)("input",{type:"text",id:"cardNumber",placeholder:"____ ____ ____ ____","onUpdate:modelValue":t[0]||(t[0]=function(e){return B.cardnumber=e}),class:"form-control form-control-sm","data-checkout":"cardNumber"},null,512),[[A,"#### #### #### ####"],[a.nr,B.cardnumber]])]),(0,a._)("div",s,[i,(0,a.wy)((0,a._)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=function(e){return B.expiration=e}),placeholder:"",class:"form-control form-control-sm"},null,512),[[a.nr,B.expiration],[A,"##/####"]]),(0,a._)("input",{type:"hidden",id:"cardExpirationMonth",value:B.card_expiration.expirationMonth,"data-checkout":"cardExpirationMonth"},null,8,c),(0,a._)("input",{type:"hidden",id:"cardExpirationYear",value:B.card_expiration.expirationYear,"data-checkout":"cardExpirationYear"},null,8,m),u,p]),h,(0,a._)("div",y,[_,(0,a.wy)((0,a._)("input",f,null,512),[[A,"###"]])]),(0,a.wy)((0,a._)("div",v,g,512),[[a.F8,B.showstallmants]]),b,(0,a._)("div",I,[E,(0,a.wy)((0,a._)("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=function(e){return B.cpf=e}),placeholder:"",class:"form-control form-control-sm"},null,512),[[a.nr,B.cpf],[A,"###.###.###-##"]]),x,(0,a._)("input",{id:"docNumber",value:B.cpf,"data-checkout":"docNumber",type:"hidden"},null,8,C)]),(0,a._)("div",M,[(0,a._)("button",{type:"submit",id:"form-checkout__submit",class:"btn btn-success",disabled:B.loadPayment,onClick:t[3]||(t[3]=(0,a.iM)((function(){return P._payCard&&P._payCard.apply(P,arguments)}),["prevent"]))},(0,a.zw)(B.loadPayment?"Processando...":"Pagar"),9,w)])])])}},3744:(e,t)=>{t.Z=(e,t)=>{const o=e.__vccOpts||e;for(const[e,a]of t)o[e]=a;return o}},288:(e,t,o)=>{o.r(t),o.d(t,{default:()=>r});var a=o(3533),n=o(4210);const r=(0,o(3744).Z)(n.Z,[["render",a.s]])},4210:(e,t,o)=>{o.d(t,{Z:()=>a.Z});var a=o(8661)},3533:(e,t,o)=>{o.d(t,{s:()=>a.s});var a=o(2231)}}]);