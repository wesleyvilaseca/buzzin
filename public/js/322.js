"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[322],{8116:(e,t,o)=>{o.d(t,{A:()=>n});var a=o(7695);const n={props:{tenant:Object,plan:Object},components:{},created:function(){this.startMp()},mounted:function(){},data:function(){return{loadPayment:!1,cardnumber:"",cpf:"",expiration:"",card_expiration:{expirationMonth:"",expirationYear:""},showstallmants:!1,paymentMethodId:""}},computed:{},methods:{_payCard:function(){this.loadPayment=!0,document.getElementById("docNumber").value=this.cpf.replace(/[^a-zA-Z0-9]/g,""),document.getElementById("docType").value="CPF",window.Mercadopago.createToken(document.getElementById("pay"),this.setCardTokenAndPay)},setCardTokenAndPay:function(e,t){var o=this;if(200==e||201==e){var n,r=document.getElementById("installments");axios.post("/api/v1/paycard",{token:t.id,payment_method_id:this.paymentMethodId,plan_id:this.plan.id,email:document.getElementById("email").value,installments:null!==(n=null==r?void 0:r.value)&&void 0!==n?n:1,cpf:this.cpf.replace(/[^a-zA-Z0-9]/g,"")}).then((function(e){var t=e.data;a.oR.success("Transação realizado com sucesso",{autoClose:3e3}),window.location.href=t.redirect})).catch((function(e){o.clearCardForm(),a.oR.error("Erro na transação",{autoClose:3e3})})).finally((function(){o.loadPayment=!1}))}else this.loadPayment=!1,this._setError(t.cause[0].code)},setPaymentMethod:function(e,t){200==e?(this.paymentMethodId=t[0].id,document.getElementById("secure_thumbnail").src=t[0].secure_thumbnail):alert("".concat(t))},getIssuers:function(e){window.Mercadopago.getIssuers(e,this.setIssuers)},setIssuers:function(e,t){if(200==e){var o=document.getElementById("issuer");t.forEach((function(e){var t=document.createElement("option");t.text=e.name,t.value=e.id,o.appendChild(t)}))}else alert("issuers method info error: ".concat(t))},getInstallments:function(){window.Mercadopago.getInstallments({payment_method_id:this.paymentMethodId,amount:parseFloat(document.getElementById("transactionAmount").value),issuer_id:25},this.setInstallments)},setInstallments:function(e,t){200==e?(this.showstallmants=!0,document.getElementById("installments").options.length=0,t[0].payer_costs.forEach((function(e){var t=document.createElement("option");t.text=e.recommended_message,t.value=e.installments,document.getElementById("installments").appendChild(t)}))):this.showstallmants=!1},_setError:function(e){"205"===e&&a.oR.error("Digite o número do seu cartão.",{autoClose:3e3}),"E301"===e&&a.oR.error("Número do cartão inválido.",{autoClose:3e3}),"E302"===e&&a.oR.error("Confira o código de segurança.",{autoClose:3e3}),"221"===e&&a.oR.error("Digite o nome impresso no cartão.",{autoClose:3e3}),"208"!==e&&"209"!==e||a.oR.error("Digite o vencimento cartão.",{autoClose:3e3}),"325"!==e&&"326"!==e||a.oR.error("Vencimento do cartão inválido.",{autoClose:3e3}),"214"===e&&a.oR.error("Informe o número do seu CPF.",{autoClose:3e3}),"324"===e&&a.oR.error("Número do CPF inválido.",{autoClose:3e3})},clearCardForm:function(){document.getElementById("cardNumber").value="",document.getElementById("secure_thumbnail").src="",document.getElementById("cardExpirationMonth").value="",document.getElementById("cardExpirationYear").value="",document.getElementById("paymentMethodId").value="",document.getElementById("cardholderName").value="",document.getElementById("securityCode").value="",document.getElementById("email").value="",document.getElementById("docType").value="",document.getElementById("docNumber").value="",this.cardnumber="",this.cpf="",this.expiration="",this.card_expiration={expirationMonth:"",expirationYear:""},this.showstallmants=!1,this.startMp()},startMp:function(){var e=this,t=document.createElement("script");t.src="https://secure.mlstatic.com/sdk/javascript/v1/mercadopago.js",t.addEventListener("load",(function(){window.Mercadopago.setPublishableKey(e.tenant.mpkey)})),document.body.appendChild(t);var o=document.querySelector("iframe");o&&(document.body.removeChild(o),document.body.removeChild(t))}},watch:{cardnumber:function(){var e=this.cardnumber.replace(/\s/g,"");e.length>=7&&window.Mercadopago.getPaymentMethod({bin:e.substring(0,6)},this.setPaymentMethod),16==e.length&&document.getElementById("paymentMethodId").value&&this.getInstallments()},paymentMethodId:function(){16==this.cardnumber.replace(/\s/g,"").length&&this.paymentMethodId&&this.getInstallments()},expiration:function(){if(this.expiration.includes("/")){var e=this.expiration.split("/");this.card_expiration.expirationMonth=e[0],this.card_expiration.expirationYear=e[1]}}}}},6695:(e,t,o)=>{o.d(t,{X:()=>M});var a=o(9726),n={id:"pay"},r={class:"row"},d={class:"form-group mt-2 col-md-8"},l=(0,a.Lk)("label",{class:"mb-1"},[(0,a.Lk)("span",null,[(0,a.Lk)("img",{id:"secure_thumbnail"})]),(0,a.eW)(" Número do cartão: ")],-1),s={class:"form-group mt-2 col-md-4"},c=(0,a.Lk)("label",{class:"mb-1"},"Vencimento:",-1),i=["value"],m=["value"],u=(0,a.Lk)("input",{type:"hidden",id:"paymentMethodId"},null,-1),p=(0,a.Lk)("input",{type:"hidden",id:"transactionAmount",value:"100"},null,-1),h=(0,a.Lk)("div",{class:"form-group mt-2 col-md-8"},[(0,a.Lk)("label",{class:"mb-1"},"Nome impresso no cartão:"),(0,a.Lk)("input",{type:"text",id:"cardholderName",placeholder:"",class:"text-uppercase form-control form-control-sm","data-checkout":"cardholderName"})],-1),y={class:"form-group mt-2 col-md-4"},f=(0,a.Lk)("label",{class:"mb-1"},"CVV:",-1),v={type:"text",id:"securityCode",placeholder:"",class:"form-control form-control-sm","data-checkout":"securityCode"},g={class:"form-group mt-2 col-md-12"},b=[(0,a.Lk)("label",{class:"mb-1"},"Parcelas:",-1),(0,a.Lk)("select",{class:"form-select form-select-sm",id:"installments"},null,-1)],k=(0,a.Lk)("div",{class:"form-group mt-2 col-md-12"},[(0,a.Lk)("label",{class:"mb-1"},"EMAIL:"),(0,a.Lk)("input",{type:"email",id:"email",placeholder:"",class:"form-control form-control-sm"})],-1),_={class:"form-group mt-2 col-md-12"},I=(0,a.Lk)("label",{class:"mb-1"},"CPF:",-1),E=(0,a.Lk)("input",{id:"docType",value:"CPF","data-checkout":"docType",type:"hidden"},null,-1),x=["value"],C={class:"text-right mt-2 d-grid gap-2"},L=["disabled"];function M(e,t,o,M,w,B){var P=(0,a.gN)("mask");return(0,a.uX)(),(0,a.CE)("form",n,[(0,a.Lk)("div",r,[(0,a.Lk)("div",d,[l,(0,a.bo)((0,a.Lk)("input",{type:"text",id:"cardNumber",placeholder:"____ ____ ____ ____","onUpdate:modelValue":t[0]||(t[0]=function(e){return w.cardnumber=e}),class:"form-control form-control-sm","data-checkout":"cardNumber"},null,512),[[P,"#### #### #### ####"],[a.Jo,w.cardnumber]])]),(0,a.Lk)("div",s,[c,(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=function(e){return w.expiration=e}),placeholder:"",class:"form-control form-control-sm"},null,512),[[a.Jo,w.expiration],[P,"##/####"]]),(0,a.Lk)("input",{type:"hidden",id:"cardExpirationMonth",value:w.card_expiration.expirationMonth,"data-checkout":"cardExpirationMonth"},null,8,i),(0,a.Lk)("input",{type:"hidden",id:"cardExpirationYear",value:w.card_expiration.expirationYear,"data-checkout":"cardExpirationYear"},null,8,m),u,p]),h,(0,a.Lk)("div",y,[f,(0,a.bo)((0,a.Lk)("input",v,null,512),[[P,"###"]])]),(0,a.bo)((0,a.Lk)("div",g,b,512),[[a.aG,w.showstallmants]]),k,(0,a.Lk)("div",_,[I,(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=function(e){return w.cpf=e}),placeholder:"",class:"form-control form-control-sm"},null,512),[[a.Jo,w.cpf],[P,"###.###.###-##"]]),E,(0,a.Lk)("input",{id:"docNumber",value:w.cpf,"data-checkout":"docNumber",type:"hidden"},null,8,x)]),(0,a.Lk)("div",C,[(0,a.Lk)("button",{type:"submit",id:"form-checkout__submit",class:"btn btn-success",disabled:w.loadPayment,onClick:t[3]||(t[3]=(0,a.D$)((function(){return B._payCard&&B._payCard.apply(B,arguments)}),["prevent"]))},(0,a.v_)(w.loadPayment?"Processando...":"Pagar"),9,L)])])])}},6262:(e,t)=>{t.A=(e,t)=>{const o=e.__vccOpts||e;for(const[e,a]of t)o[e]=a;return o}},9322:(e,t,o)=>{o.r(t),o.d(t,{default:()=>r});var a=o(6236),n=o(3687);const r=(0,o(6262).A)(n.A,[["render",a.X]])},3687:(e,t,o)=>{o.d(t,{A:()=>a.A});var a=o(8116)},6236:(e,t,o)=>{o.d(t,{X:()=>a.X});var a=o(6695)}}]);