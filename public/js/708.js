"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[708],{3744:(e,t)=>{t.Z=(e,t)=>{const o=e.__vccOpts||e;for(const[e,n]of t)o[e]=n;return o}},9708:(e,t,o)=>{o.r(t),o.d(t,{default:()=>j});var n=o(821),r={id:"pay"},a={class:"row"},i={class:"form-group mt-2 col-md-8"},c=(0,n._)("label",{class:"mb-1"},[(0,n._)("span",null,[(0,n._)("img",{id:"secure_thumbnail"})]),(0,n.Uk)(" Número do cartão: ")],-1),s={class:"form-group mt-2 col-md-4"},l=(0,n._)("label",{class:"mb-1"},"Vencimento:",-1),d=["value"],u=["value"],m=(0,n._)("input",{type:"hidden",id:"paymentMethodId"},null,-1),p=(0,n._)("input",{type:"hidden",id:"transactionAmount",value:"100"},null,-1),h=(0,n._)("div",{class:"form-group mt-2 col-md-8"},[(0,n._)("label",{class:"mb-1"},"Nome impresso no cartão:"),(0,n._)("input",{type:"text",id:"cardholderName",placeholder:"",class:"text-uppercase form-control form-control-sm","data-checkout":"cardholderName"})],-1),f={class:"form-group mt-2 col-md-4"},y=(0,n._)("label",{class:"mb-1"},"CVV:",-1),g={type:"text",id:"securityCode",placeholder:"",class:"form-control form-control-sm","data-checkout":"securityCode"},_={class:"form-group mt-2 col-md-12"},b=[(0,n._)("label",{class:"mb-1"},"Parcelas:",-1),(0,n._)("select",{class:"form-select form-select-sm",id:"installments"},null,-1)],v=(0,n._)("div",{class:"form-group mt-2 col-md-12"},[(0,n._)("label",{class:"mb-1"},"EMAIL:"),(0,n._)("input",{type:"email",id:"email",placeholder:"",class:"form-control form-control-sm"})],-1),E={class:"form-group mt-2 col-md-12"},I=(0,n._)("label",{class:"mb-1"},"CPF:",-1),C=(0,n._)("input",{id:"docType",value:"CPF","data-checkout":"docType",type:"hidden"},null,-1),x=["value"],M={class:"text-right mt-2 d-grid gap-2"};var w=o(3907),P=o(8874);function k(e){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},k(e)}function A(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function O(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?A(Object(o),!0).forEach((function(t){B(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):A(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function B(e,t,o){return(t=function(e){var t=function(e,t){if("object"!==k(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,t||"default");if("object"!==k(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===k(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}const S={props:[],components:{},data:function(){return{token_name:"buzzin",cardnumber:"",cpf:"",expiration:"",card_expiration:{expirationMonth:"",expirationYear:""},showstallmants:!1,paymentMethodId:""}},computed:O(O({},(0,w.rn)({selectedPaymentMethod:function(e){return e.cart.selectedPaymentMethod},selectedAddress:function(e){return e.cart.selectedAddress},products:function(e){return e.cart.products.data},shippingMethods:function(e){return e.cart.shippingMethods},comment:function(e){return e.cart.comment},troco:function(e){return e.cart.troco},precisa_troco:function(e){return e.cart.precisa_troco},selectedShippingMethod:function(e){return e.cart.selectedShippingMethod},company:function(e){return e.tenant.company}})),{},{mpConfig:function(){return JSON.parse(this.selectedPaymentMethod.data)}}),mounted:function(){},created:function(){this.startMp()},methods:O(O({},(0,w.OI)({clearCart:"CLEAR_CART",setPreloader:"SET_PRELOADER",setTextPreloader:"SET_TEXT_PRELOADER"})),{},{startMp:function(){var e=this,t=document.createElement("script");t.src="https://secure.mlstatic.com/sdk/javascript/v1/mercadopago.js",t.addEventListener("load",(function(){window.Mercadopago.setPublishableKey(e.mpConfig.public_key)})),document.body.appendChild(t);var o=document.querySelector("iframe");o&&(document.body.removeChild(o),document.body.removeChild(t))},_payCard:function(){document.getElementById("docNumber").value=this.cpf.replace(/[^a-zA-Z0-9]/g,""),document.getElementById("docType").value="CPF",window.Mercadopago.createToken(document.getElementById("pay"),this.setCardTokenAndPay)},setCardTokenAndPay:function(e,t){var o=this;if(200==e||201==e){var n;this.setTextPreloader("Finalizando pedido...");var r=document.getElementById("installments"),a={address:this.selectedAddress,products:this.products,shippingMethod:this.selectedShippingMethod,comment:this.comment,paymentMethod:this.selectedPaymentMethod,precisaTroco:this.precisa_troco?"Y":"N",troco:this.troco?this.troco:0,payment_integration_params:{token:t.id,payment_method_id:this.paymentMethodId,first_name:this.firstname,last_name:this.lastname,email:document.getElementById("email").value,cpf:this.cpf.replace(/[^a-zA-Z0-9]/g,""),installments:null!==(n=null==r?void 0:r.value)&&void 0!==n?n:1}},i=localStorage.getItem(this.token_name),c=new URLSearchParams({token_company:this.company.uuid}).toString(),s="/api/auth/v1/mp-order?".concat(c);return axios.post(s,a,{headers:{Authorization:"Bearer ".concat(i)}}).then((function(e){var t=e.data.data;P.Am.success("Pedido realizado com sucesso",{autoClose:3e3}),o.clearCart(o.company.uuid),window.location.href="http://".concat(o.company.domain,"/app/cliente-area?identify=").concat(t.identify)})).catch((function(e){if(null!=e&&e.response){var t=e.response;o.errors=Object.assign(o.errors,t.data.errors)}P.Am.error("Falha ao gerar boleto, tente novamente",{autoClose:5e3})})).finally((function(){o.setTextPreloader("Carregando...")}))}this._setError(t.cause[0].code)},setPaymentMethod:function(e,t){200==e?(this.paymentMethodId=t[0].id,document.getElementById("secure_thumbnail").src=t[0].secure_thumbnail):alert("".concat(t))},getIssuers:function(e){window.Mercadopago.getIssuers(e,this.setIssuers)},setIssuers:function(e,t){if(200==e){var o=document.getElementById("issuer");t.forEach((function(e){var t=document.createElement("option");t.text=e.name,t.value=e.id,o.appendChild(t)}))}else alert("issuers method info error: ".concat(t))},getInstallments:function(){window.Mercadopago.getInstallments({payment_method_id:this.paymentMethodId,amount:parseFloat(document.getElementById("transactionAmount").value),issuer_id:25},this.setInstallments)},setInstallments:function(e,t){200==e?(this.showstallmants=!0,document.getElementById("installments").options.length=0,t[0].payer_costs.forEach((function(e){var t=document.createElement("option");t.text=e.recommended_message,t.value=e.installments,document.getElementById("installments").appendChild(t)}))):this.showstallmants=!1},_setError:function(e){"205"===e&&P.Am.error("Digite o número do seu cartão.",{autoClose:3e3}),"E301"===e&&P.Am.error("Número do cartão inválido.",{autoClose:3e3}),"E302"===e&&P.Am.error("Confira o código de segurança.",{autoClose:3e3}),"221"===e&&P.Am.error("Digite o nome impresso no cartão.",{autoClose:3e3}),"208"!==e&&"209"!==e||P.Am.error("Digite o vencimento cartão.",{autoClose:3e3}),"325"!==e&&"326"!==e||P.Am.error("Vencimento do cartão inválido.",{autoClose:3e3}),"214"===e&&P.Am.error("Informe o número do seu CPF.",{autoClose:3e3}),"324"===e&&P.Am.error("Número do CPF inválido.",{autoClose:3e3})},clearCardForm:function(){document.getElementById("cardNumber").value="",document.getElementById("secure_thumbnail").src="",document.getElementById("cardExpirationMonth").value="",document.getElementById("cardExpirationYear").value="",document.getElementById("paymentMethodId").value="",document.getElementById("cardholderName").value="",document.getElementById("securityCode").value="",document.getElementById("email").value="",document.getElementById("docType").value="",document.getElementById("docNumber").value="",this.cardnumber="",this.cpf="",this.expiration="",this.card_expiration={expirationMonth:"",expirationYear:""},this.showstallmants=!1,this.startMp()}}),watch:{cardnumber:function(){var e=this.cardnumber.replace(/\s/g,"");e.length>=7&&window.Mercadopago.getPaymentMethod({bin:e.substring(0,6)},this.setPaymentMethod),16==e.length&&document.getElementById("paymentMethodId").value&&this.getInstallments()},paymentMethodId:function(){16==this.cardnumber.replace(/\s/g,"").length&&this.paymentMethodId&&this.getInstallments()},expiration:function(){if(this.expiration.includes("/")){var e=this.expiration.split("/");this.card_expiration.expirationMonth=e[0],this.card_expiration.expirationYear=e[1]}}}};const j=(0,o(3744).Z)(S,[["render",function(e,t,o,w,P,k){var A=(0,n.Q2)("mask");return(0,n.wg)(),(0,n.iD)("form",r,[(0,n._)("div",a,[(0,n._)("div",i,[c,(0,n.wy)((0,n._)("input",{type:"text",id:"cardNumber",placeholder:"____ ____ ____ ____","onUpdate:modelValue":t[0]||(t[0]=function(t){return e.cardnumber=t}),class:"form-control form-control-sm","data-checkout":"cardNumber"},null,512),[[A,"#### #### #### ####"],[n.nr,e.cardnumber]])]),(0,n._)("div",s,[l,(0,n.wy)((0,n._)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=function(t){return e.expiration=t}),placeholder:"",class:"form-control form-control-sm"},null,512),[[n.nr,e.expiration],[A,"##/####"]]),(0,n._)("input",{type:"hidden",id:"cardExpirationMonth",value:e.card_expiration.expirationMonth,"data-checkout":"cardExpirationMonth"},null,8,d),(0,n._)("input",{type:"hidden",id:"cardExpirationYear",value:e.card_expiration.expirationYear,"data-checkout":"cardExpirationYear"},null,8,u),m,p]),h,(0,n._)("div",f,[y,(0,n.wy)((0,n._)("input",g,null,512),[[A,"###"]])]),(0,n.wy)((0,n._)("div",_,b,512),[[n.F8,e.showstallmants]]),v,(0,n._)("div",E,[I,(0,n.wy)((0,n._)("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=function(t){return e.cpf=t}),placeholder:"",class:"form-control form-control-sm"},null,512),[[n.nr,e.cpf],[A,"###.###.###-##"]]),C,(0,n._)("input",{id:"docNumber",value:e.cpf,"data-checkout":"docNumber",type:"hidden"},null,8,x)]),(0,n._)("div",M,[(0,n._)("button",{type:"submit",id:"form-checkout__submit",class:"btn btn-success",onClick:t[3]||(t[3]=(0,n.iM)((function(){return k._payCard&&k._payCard.apply(k,arguments)}),["prevent"]))}," Pagar")])])])}]])}}]);